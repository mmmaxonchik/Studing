
# Сетевой уровень
Сетевой уровень является основой интернета и предназначен для объединения сети с построением на основе разных технологий:
+ Ethernet
+ Wi-Fi
+ 5G/4G/3G
+ ...
Так как все эти технологии различаются во многих аспектах, например таких как: Сервисы(С гарантией доставки, Без гарантии доставки), Адресация(Разный размер, разные идентификаторы), Широковещание(Есть или нет),  Размер кадра(1500 или 2304) итд, был придуман сетевой уровень, он **согласует различия в сетях**.

Также сетевой уровень предлагает **масштабируемость**, за счёт:
+ Агрегации адресов - работа не с отдельными адресами, а с блоками адресов(сеть)
+ Запрет пересылки мусорных пакетов - пакет отбрасывается, если нельзя определить, куда нужно его отправить
+ Возможность наличия нескольких путей в сети - маршрутизация

**Итог - задачами сетевого уровня является:**
+ Объединение сетей
+ Маршрутизация
+ Обеспечение качества обслуживания

**Оборудованием сетевого уровня являются _маршрутизаторы_**
Маршрутизатор - это устройство для объединения сетей, у которого есть несколько интерфейсов к которым подключаются сети. У каждого интерфейса есть адрес.
![Маршрутизация](https://zvondozvon.ru/wp-content/uploads/2020/02/variant-deistv-mars.jpg)

**Что такое маршрутизация?**
Маршрутизация(routing)- это поиск маршрута доставки пакета между сетями через транзитные узлы - маршрутизаторы. Сложность маршрутизации заключается в учете изменений в топологии сети, и в учете загрузки каналов связи и маршрутизаторов.

**Протоколы сетевого уровня:**
+ IP(Internet Protocol) - используется для передачи данных  
+ ICMP(Internet Count Message Protocol) - используется для управления сетью
+ ARP(Address Resolution Protocol) - используется для того чтобы по глобальному адресу сетевого уровня определить адрес канального уровня
+ DHCP(Dynamic Host Configuration Protocol) - используется для того чтобы автоматически назначать IP адреса в составной сети

## IP-адреса
IP-адреса - глобальные адреса в стеке протоколов TCP/IP, используются для уникальной идентификации компьютеров в составной сети.
В сетях используется два типа адресов: 
+ Локальные - используются на канальном уровне
+ + Адреса в технологии канального уровня: MAC или IMEI
+ + Привязаны к конкретной технологии
+ Глобальные - используются на сетевом уровне 
+ + Адреса сетевого уровня: IP-адреса
+ + Не привязаны к технологии
+ + Применяются при объединении сетей 

_Подсеть_ - это множество компьютеров, у которых старшая часть IP-адреса одинаковая, например:
+ 213.***.***.***
+ 213.***.***.***
+ итд...
Маршрутизаторы работают с подсетями, а не с отдельными компьютерами.

**Структура IP адреса:**
+ Номер подсети - старшие биты
+ Номер хоста - младшие биты

**Маска подсети** - показывает, где в IP-адресе номер сети, где номер хоста. Маска работает по следующему принципу: там где в позициях единицы - это номер сети, а где нули - это номер хоста. Маску можно записать в двух видах:
+ В десятичном представлении - 255.255.255.0
+ В виде префикса - /24 - после слэша указывается сколько первых бит идет на номер сети, все остальное будет номером хоста. 

**У IP протокола есть две версии:**
+ IPv4 - адрес 4 байта
+ IPv6 - адрес 16 байт 

**IPv4** - форма представления 4 десятичных числа 0-255 разделенных точкой
Сетевой уровень использует агрегацию адресов, поэтому масштабирование - это работа не с отдельными адресами, а с подсетями(subnet)

### Типы IP-адресов
+ Индивидуальный(Unicast) - это адрес конкретного компьютера в сети
+ Групповой(Multicast) - это адрес использующиеся несколькими компьютерами, если мы отправим данные по этому адресу, то его получат все компьютеры с одинаковым адресом в подсети
+ Широковещательный(Broadcast) - это адрес использующийся всеми компьютерами в сети, если мы отправим данные по этому адресу, то его получат все компьютеры в подсети

**Широковещательный адрес** - имеет все единицы единицы в конце, т.е. ***.***.***.255. Широковещательные пакеты передаются только внутри подсети. 

**Специальные IP-адреса:**
+ Битовые единицы в номере хоста(***.***.***.255) - это широковещательный адрес
+ Битовые нули в номере хоста(***.***.***.0) - это адрес подсети
+ Хост с номером 1 (***.***.***.1)(по умолчанию) - маршрутизатор
+ Адрес из всех нулей (000.000.000.000) - текущий хост(подсеть)
+ Адрес из всех 255 (255.255.255.255) - все хосты в текущей подсети
+ 127.0.0.0/8 - обратная петля(loopback) - сеть для тестирования, данные не передаются
+ 169.254.0.0/16 - Link-local адреса
